## 图像检测（2022.9.18）

考虑到百度模型部署方面的成本过高，经过仔细挑选后，改为使用最新的yolov5图像检测模型。

该模型的源码地址：https://github.com/ultralytics/yolov5.git

目前主要在尝试解决图像推理的速度问题，其关键在于小图合成的**速度过慢**，原因是在合成程序中大量嵌套使用了python的for循环逻辑，python的for循环效率相当低。

因此，经过与范同学的讨论，决定采用C++重写合成程序。合成程序的关键一方面在于正确解析yolo模型推理小图得到的结果json文件，另一方面寻找就是求解IOU（交并比）的合适算法。

其中json文件的解析问题在已经解决，使用了GitHub上的[nlohmann](https://github.com/nlohmann)项目，该项目可以很好的处理多层嵌套的json文件。

目前重点攻克的方向为寻找求解IOU的合适算法，由于标注框是旋转集合体，IOU的求解会相对困难，目前的思路主要有两个：

- **根据几何结构直接求解**，具体来说：

  多边形的顶点包括以下两部分：
  1. 所有相交的线段交点;
    2.所有在对方内部的知形顶点。
    因此整个求解过程可以分为以下四步：
    1.找到所有的线段交点;
    2.找到所有的在对方内部的知形顶点;
  2. 求出以上两个点集并的凸包；
  3. 求出凸包面积。

- 利用OpenGL对每个矩形包含的像素点进行染色，最后数特定颜色的像素点。





